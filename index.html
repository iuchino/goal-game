<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The North Star v4 - Shield Edition</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root { --accent: #00d4ff; --danger: #ff4b4b; --bg: #050507; }
        body { margin: 0; background: var(--bg); color: white; font-family: -apple-system, sans-serif; height: 100vh; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .screen { display: none; padding: 40px; animation: scaleIn 0.5s ease-out; width: 100%; box-sizing: border-box; }
        .active { display: flex; flex-direction: column; align-items: center; }
        .label { color: var(--accent); text-transform: uppercase; font-size: 0.75rem; letter-spacing: 5px; margin-bottom: 15px; opacity: 0.8; }
        .goal-display { font-size: 2rem; font-weight: 800; line-height: 1.2; max-width: 800px; }
        
        /* Temptation Shield UI */
        #shield-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,0,0,0.15); backdrop-filter: blur(20px); z-index: 200; flex-direction: column; align-items: center; justify-content: center; padding: 30px; box-sizing: border-box; }
        .warning-box { border: 2px solid var(--danger); padding: 30px; border-radius: 20px; background: black; box-shadow: 0 0 50px rgba(255,75,75,0.4); }
        .warning-title { color: var(--danger); font-size: 1.5rem; font-weight: 900; text-transform: uppercase; margin-bottom: 15px; }
        
        /* Menu & Buttons */
        #menu { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 100; overflow-y: auto; padding: 30px; box-sizing: border-box; }
        .input-group { margin-bottom: 25px; text-align: left; max-width: 500px; margin: 0 auto 25px auto; }
        input, textarea { width: 100%; background: #1a1a1c; border: 1px solid var(--accent); color: white; padding: 15px; border-radius: 10px; font-size: 1rem; box-sizing: border-box; }
        .btn { background: var(--accent); color: black; border: none; padding: 20px 45px; font-size: 1.1rem; font-weight: 800; border-radius: 12px; cursor: pointer; margin-top: 15px; text-transform: uppercase; }
        .btn-danger { background: var(--danger); color: white; margin-top: 40px; }
        .settings-icon { position: fixed; bottom: 30px; right: 30px; font-size: 24px; opacity: 0.2; z-index: 101; }
        .timer-bar { position: fixed; top: 0; left: 0; height: 4px; background: var(--accent); width: 0%; }
        @keyframes scaleIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>

    <div class="settings-icon" onclick="toggleMenu()">‚öôÔ∏è</div>

    <div id="shield-overlay">
        <div class="warning-box">
            <div class="warning-title">‚ö†Ô∏è SYSTEM ALERT</div>
            <p id="shield-message" style="font-size: 1.2rem; line-height: 1.5;"></p>
            <button class="btn" style="background: white;" onclick="closeShield()">I AM STRONGER. BACK TO MISSION.</button>
        </div>
    </div>

    <div id="menu">
        <h2 style="color: var(--accent);">Strategic Configuration</h2>
        <div id="editor-fields"></div>
        <div class="input-group">
            <label style="color: var(--danger)">TEMPTATION WARNING (The Risk)</label>
            <textarea id="input-temptation" rows="4">Giving in now resets your momentum. This choice threatens your 10-year freedom and your health. Is 5 minutes of pleasure worth 5 months of regret?</textarea>
        </div>
        <button class="btn" onclick="saveAndRestart()">Commit Changes</button>
        <button class="btn" style="background:transparent; color:#666;" onclick="toggleMenu()">Discard</button>
    </div>

    <div id="display-container"></div>
    <div id="progress" class="timer-bar"></div>

    <script>
        const configs = [
            { id: 'life', label: 'Life Legacy', time: 4000 },
            { id: '10yr', label: 'The 10-Year Gate', time: 4000 },
            { id: '3yr', label: 'The 3-Year Quest', time: 4000 },
            { id: '1yr', label: 'The 1-Year Campaign', time: 4000 },
            { id: 'week', label: 'Weekly Mission', time: 0 } 
        ];

        let goals = JSON.parse(localStorage.getItem('v4Goals')) || {
            life: 'Example Life Goal', '10yr': 'Example 10yr Goal', '3yr': 'Example 3yr Goal', '1yr': 'Example 1yr Goal', week: 'Example Week Goal',
            temptation: 'This action directly sabotages your retirement and health. If you continue, you are choosing a weaker version of yourself. STOP.'
        };

        function initApp() {
            const container = document.getElementById('display-container');
            const editor = document.getElementById('editor-fields');
            container.innerHTML = ''; editor.innerHTML = '';

            configs.forEach((c, index) => {
                const div = document.createElement('div');
                div.id = `screen-${c.id}`;
                div.className = `screen ${index === 0 ? 'active' : ''}`;
                div.innerHTML = `<div class="label">${c.label}</div><div class="goal-display">${goals[c.id]}</div>`;
                if(index === configs.length - 1) {
                    div.innerHTML += `
                        <button class="btn" onclick="openToDo()">Initiate Tactics</button>
                        <button class="btn btn-danger" onclick="activateShield()">üõ°Ô∏è RESIST TEMPTATION</button>`;
                }
                container.appendChild(div);
                editor.innerHTML += `<div class="input-group"><label>${c.label}</label><input type="text" id="input-${c.id}" value="${goals[c.id]}"></div>`;
            });
            document.getElementById('input-temptation').value = goals.temptation;
            startSequence();
        }

        let timer;
        function showScreen(index) {
            clearTimeout(timer);
            const screens = document.querySelectorAll('.screen');
            screens.forEach(s => s.classList.remove('active'));
            screens[index].classList.add('active');
            if (configs[index].time > 0) {
                const bar = document.getElementById('progress');
                bar.style.transition = 'none'; bar.style.width = '0%';
                setTimeout(() => { bar.style.transition = `width ${configs[index].time}ms linear`; bar.style.width = '100%'; }, 50);
                timer = setTimeout(() => showScreen(index + 1), configs[index].time);
            } else { document.getElementById('progress').style.display = 'none'; }
        }

        function startSequence() { document.getElementById('progress').style.display = 'block'; showScreen(0); }
        function toggleMenu() { const m = document.getElementById('menu'); m.style.display = m.style.display === 'block' ? 'none' : 'block'; clearTimeout(timer); }
        function saveAndRestart() {
            configs.forEach(c => { goals[c.id] = document.getElementById(`input-${c.id}`).value; });
            goals.temptation = document.getElementById('input-temptation').value;
            localStorage.setItem('v4Goals', JSON.stringify(goals));
            toggleMenu(); initApp();
        }

        function activateShield() {
            document.getElementById('shield-message').innerText = goals.temptation;
            document.getElementById('shield-overlay').style.display = 'flex';
        }
        function closeShield() { document.getElementById('shield-overlay').style.display = 'none'; }
        function openToDo() { window.location.href = "to-do://"; setTimeout(() => { window.location.href = "https://to-do.microsoft.com/"; }, 1000); }
        window.onload = initApp;
    </script>
</body>
</html>
